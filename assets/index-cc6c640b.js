import{h as d,r as i,a as O}from"./index-abeb7a9d.js";import{d as x,a as E,f as I,e as S,$ as P}from"./index-35a8bba8.js";function w(e,t,{checkForDefaultPrevented:r=!0}={}){return function(o){if(e==null||e(o),r===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function k(e){const t=e+"CollectionProvider",[r,n]=x(t),[o,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),v=u=>{const{scope:l,children:C}=u,$=d.useRef(null),N=d.useRef(new Map).current;return d.createElement(o,{scope:l,itemMap:N,collectionRef:$},C)},p=e+"CollectionSlot",a=d.forwardRef((u,l)=>{const{scope:C,children:$}=u,N=s(p,C),A=E(l,N.collectionRef);return d.createElement(I,{ref:A},$)}),c=e+"CollectionItemSlot",m="data-radix-collection-item",f=d.forwardRef((u,l)=>{const{scope:C,children:$,...N}=u,A=d.useRef(null),b=E(l,A),M=s(c,C);return d.useEffect(()=>(M.itemMap.set(A,{ref:A,...N}),()=>void M.itemMap.delete(A))),d.createElement(I,{[m]:"",ref:b},$)});function h(u){const l=s(e+"CollectionConsumer",u);return d.useCallback(()=>{const $=l.collectionRef.current;if(!$)return[];const N=Array.from($.querySelectorAll(`[${m}]`));return Array.from(l.itemMap.values()).sort((M,T)=>N.indexOf(M.ref.current)-N.indexOf(T.ref.current))},[l.collectionRef,l.itemMap])}return[{Provider:v,Slot:a,ItemSlot:f},h,n]}function U(e,t){return i.useReducer((r,n)=>{const o=t[r][n];return o??r},e)}const g=e=>{const{present:t,children:r}=e,n=_(t),o=typeof r=="function"?r({present:n.isPresent}):i.Children.only(r),s=E(n.ref,o.ref);return typeof r=="function"||n.isPresent?i.cloneElement(o,{ref:s}):null};g.displayName="Presence";function _(e){const[t,r]=i.useState(),n=i.useRef({}),o=i.useRef(e),s=i.useRef("none"),v=e?"mounted":"unmounted",[p,a]=U(v,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return i.useEffect(()=>{const c=R(n.current);s.current=p==="mounted"?c:"none"},[p]),S(()=>{const c=n.current,m=o.current;if(m!==e){const h=s.current,u=R(c);e?a("MOUNT"):u==="none"||(c==null?void 0:c.display)==="none"?a("UNMOUNT"):a(m&&h!==u?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,a]),S(()=>{if(t){const c=f=>{const u=R(n.current).includes(f.animationName);f.target===t&&u&&O.flushSync(()=>a("ANIMATION_END"))},m=f=>{f.target===t&&(s.current=R(n.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",c),t.addEventListener("animationend",c),()=>{t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",c),t.removeEventListener("animationend",c)}}else a("ANIMATION_END")},[t,a]),{isPresent:["mounted","unmountSuspended"].includes(p),ref:i.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function R(e){return(e==null?void 0:e.animationName)||"none"}function q({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,o]=y({defaultProp:t,onChange:r}),s=e!==void 0,v=s?e:n,p=P(r),a=i.useCallback(c=>{if(s){const f=typeof c=="function"?c(e):c;f!==e&&p(f)}else o(c)},[s,e,o,p]);return[v,a]}function y({defaultProp:e,onChange:t}){const r=i.useState(e),[n]=r,o=i.useRef(n),s=P(t);return i.useEffect(()=>{o.current!==n&&(s(n),o.current=n)},[n,o,s]),r}export{w as $,k as a,q as b,g as c};
